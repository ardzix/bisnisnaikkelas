{% extends 'readiness/base.html' %}

{% block title %}Assessment Form{% endblock %}

{% block extra_css %}
<style>
    body {
        background-color: #f8f9fa;
    }
    
    .form-container {
        max-width: 900px;
        margin: 0 auto;
    }
    
    .form-card {
        border: none;
        border-radius: 16px;
        box-shadow: 0 0 25px rgba(0,0,0,0.08);
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .form-header {
        background: linear-gradient(to right, #2c3e50, #4a6285);
        color: white;
        padding: 30px;
        text-align: center;
    }
    
    .form-title {
        color: white;
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 8px;
    }
    
    .form-subtitle {
        color: rgba(255, 255, 255, 0.8);
        font-size: 16px;
    }
    
    .form-body {
        padding: 30px;
        background: white;
    }
    
    .form-section {
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.03);
        margin-bottom: 20px;
        overflow: hidden;
        border: 1px solid rgba(44, 62, 80, 0.1);
        transition: all 0.3s ease;
    }
    
    .form-section:hover {
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        transform: translateY(-2px);
    }
    
    .form-section-header {
        background: linear-gradient(to right, #2c3e50, #4a6285);
        color: white;
        padding: 15px 20px;
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
    }
    
    .form-section-header i {
        margin-right: 10px;
        opacity: 0.8;
    }
    
    .form-section-body {
        padding: 20px;
    }
    
    .form-control, .form-select {
        border-radius: 8px;
        padding: 12px 15px;
        border: 1px solid rgba(44, 62, 80, 0.2);
        transition: all 0.3s;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #2c3e50;
        box-shadow: 0 0 0 0.2rem rgba(44, 62, 80, 0.15);
    }
    
    .form-check {
        margin-bottom: 12px;
        padding-left: 32px;
    }
    
    .form-check-input {
        width: 20px;
        height: 20px;
        margin-top: 0.2rem;
        border: 2px solid rgba(44, 62, 80, 0.3);
        cursor: pointer;
    }
    
    .form-check-input:checked {
        background-color: #2c3e50;
        border-color: #2c3e50;
    }
    
    .form-check-label {
        cursor: pointer;
        font-size: 15px;
        padding-top: 2px;
    }
    
    .form-label {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 8px;
    }
    
    .submit-btn {
        background: linear-gradient(to right, #2c3e50, #4a6285);
        border: none;
        border-radius: 10px;
        color: white;
        font-weight: 600;
        padding: 15px 40px;
        font-size: 18px;
        margin-top: 20px;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(44, 62, 80, 0.25);
    }
</style>
{% endblock %}

{% block content %}
<div class="form-container py-5">
    <div class="form-card">
        <div class="form-header">
            <h2 class="form-title">Assessment Bisnis Naik Kelas</h2>
            <p class="form-subtitle">Evaluasi kesiapan bisnis Anda untuk naik ke level berikutnya</p>
        </div>
        
        <div class="form-body">
            <form method="post" action="{% url 'submit_assessment' %}" id="assessmentForm">
                {% csrf_token %}
                
                <!-- Basic Information -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-info-circle"></i> Informasi Dasar
                    </div>
                    <div class="form-section-body">
                        <div class="mb-4">
                            <label for="business_name" class="form-label">Nama Bisnis</label>
                            <input type="text" class="form-control" id="business_name" name="business_name" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="business_type" class="form-label">Jenis Bisnis</label>
                            <select class="form-select" id="business_type" name="business_type" required>
                                <option value="">Pilih jenis bisnis</option>
                                <option value="manufacturing">Manufacturing</option>
                                <option value="retail">Retail</option>
                                <option value="service">Service</option>
                                <option value="food">Food & Beverage</option>
                                <option value="other">Lainnya</option>
                            </select>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <label for="year_started" class="form-label">Tahun Mulai</label>
                                    <input type="number" class="form-control" id="year_started" name="year_started" min="1900" max="2024" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <label for="employee_count" class="form-label">Jumlah Karyawan</label>
                                    <input type="number" class="form-control" id="employee_count" name="employee_count" min="1" required>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Financial Information -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-money-bill-wave"></i> Informasi Keuangan
                    </div>
                    <div class="form-section-body">
                        <div class="mb-4">
                            <label for="annual_revenue" class="form-label">Pendapatan Tahunan (IDR)</label>
                            <input type="number" class="form-control" id="annual_revenue" name="annual_revenue" min="0" required>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_financial_records" name="has_financial_records">
                                <label class="form-check-label" for="has_financial_records">
                                    Memiliki pencatatan keuangan
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_invoice_system" name="has_invoice_system">
                                <label class="form-check-label" for="has_invoice_system">
                                    Menggunakan sistem faktur
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="uses_financial_software" name="uses_financial_software">
                                <label class="form-check-label" for="uses_financial_software">
                                    Menggunakan software keuangan
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_cashflow_forecast" name="has_cashflow_forecast">
                                <label class="form-check-label" for="has_cashflow_forecast">
                                    Memiliki perkiraan arus kas
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_tax_calculation_practice" name="has_tax_calculation_practice">
                                <label class="form-check-label" for="has_tax_calculation_practice">
                                    Memiliki praktik perhitungan pajak
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Digital Presence -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-globe"></i> Kehadiran Digital
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_website" name="has_website">
                                <label class="form-check-label" for="has_website">
                                    Memiliki website
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_online_store" name="has_online_store">
                                <label class="form-check-label" for="has_online_store">
                                    Memiliki toko online
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_social_media" name="has_social_media">
                                <label class="form-check-label" for="has_social_media">
                                    Memiliki media sosial
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="is_social_media_active" name="is_social_media_active">
                                <label class="form-check-label" for="is_social_media_active">
                                    Aktif di media sosial
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="uses_digital_ads" name="uses_digital_ads">
                                <label class="form-check-label" for="uses_digital_ads">
                                    Menggunakan iklan digital
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="uses_crm_or_marketing_tools" name="uses_crm_or_marketing_tools">
                                <label class="form-check-label" for="uses_crm_or_marketing_tools">
                                    Menggunakan CRM atau alat pemasaran
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Legal Documentation -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-file-contract"></i> Dokumentasi Legal
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_npwp" name="has_npwp">
                                <label class="form-check-label" for="has_npwp">
                                    Memiliki NPWP
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_business_license" name="has_business_license">
                                <label class="form-check-label" for="has_business_license">
                                    Memiliki izin usaha
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_profit_loss_statement" name="has_profit_loss_statement">
                                <label class="form-check-label" for="has_profit_loss_statement">
                                    Memiliki laporan laba rugi
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_balance_sheet" name="has_balance_sheet">
                                <label class="form-check-label" for="has_balance_sheet">
                                    Memiliki neraca keuangan
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_contract_templates" name="has_contract_templates">
                                <label class="form-check-label" for="has_contract_templates">
                                    Memiliki template kontrak
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="registered_with_government_platforms" name="registered_with_government_platforms">
                                <label class="form-check-label" for="registered_with_government_platforms">
                                    Terdaftar di platform pemerintah
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Operational -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-cogs"></i> Operasional
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_sop_documentation" name="has_sop_documentation">
                                <label class="form-check-label" for="has_sop_documentation">
                                    Memiliki dokumentasi SOP
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_team_structure" name="has_team_structure">
                                <label class="form-check-label" for="has_team_structure">
                                    Memiliki struktur tim
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Strategy -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-chess"></i> Strategi
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_vision_and_mission" name="has_vision_and_mission">
                                <label class="form-check-label" for="has_vision_and_mission">
                                    Memiliki visi dan misi
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_business_plan" name="has_business_plan">
                                <label class="form-check-label" for="has_business_plan">
                                    Memiliki rencana bisnis
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_defined_target_market" name="has_defined_target_market">
                                <label class="form-check-label" for="has_defined_target_market">
                                    Memiliki target pasar yang jelas
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_unique_value_proposition" name="has_unique_value_proposition">
                                <label class="form-check-label" for="has_unique_value_proposition">
                                    Memiliki proposisi nilai unik
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Risk & Compliance -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-shield-alt"></i> Risiko & Kepatuhan
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_data_backup" name="has_data_backup">
                                <label class="form-check-label" for="has_data_backup">
                                    Memiliki backup data
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_been_audited" name="has_been_audited">
                                <label class="form-check-label" for="has_been_audited">
                                    Pernah diaudit
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_third_party_contracts" name="has_third_party_contracts">
                                <label class="form-check-label" for="has_third_party_contracts">
                                    Memiliki kontrak dengan pihak ketiga
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_tax_risk_management" name="has_tax_risk_management">
                                <label class="form-check-label" for="has_tax_risk_management">
                                    Memiliki manajemen risiko pajak
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_internal_controls" name="has_internal_controls">
                                <label class="form-check-label" for="has_internal_controls">
                                    Memiliki kontrol internal
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Technology -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-laptop-code"></i> Teknologi
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="uses_inventory_software" name="uses_inventory_software">
                                <label class="form-check-label" for="uses_inventory_software">
                                    Menggunakan software inventaris
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="can_operate_remotely" name="can_operate_remotely">
                                <label class="form-check-label" for="can_operate_remotely">
                                    Dapat beroperasi secara remote
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="uses_automation_or_integration" name="uses_automation_or_integration">
                                <label class="form-check-label" for="uses_automation_or_integration">
                                    Menggunakan otomatisasi atau integrasi
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_internal_dashboard_or_kpi_system" name="has_internal_dashboard_or_kpi_system">
                                <label class="form-check-label" for="has_internal_dashboard_or_kpi_system">
                                    Memiliki dashboard internal atau sistem KPI
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Market Access -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-store"></i> Akses Pasar
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="sells_nationally_or_internationally" name="sells_nationally_or_internationally">
                                <label class="form-check-label" for="sells_nationally_or_internationally">
                                    Menjual secara nasional atau internasional
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="attends_trade_expos" name="attends_trade_expos">
                                <label class="form-check-label" for="attends_trade_expos">
                                    Menghadiri pameran dagang
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_reseller_or_distributor" name="has_reseller_or_distributor">
                                <label class="form-check-label" for="has_reseller_or_distributor">
                                    Memiliki reseller atau distributor
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_partnership_program" name="has_partnership_program">
                                <label class="form-check-label" for="has_partnership_program">
                                    Memiliki program kemitraan
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Process Maturity -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-tasks"></i> Kematangan Proses
                    </div>
                    <div class="form-section-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_payroll_system" name="has_payroll_system">
                                <label class="form-check-label" for="has_payroll_system">
                                    Memiliki sistem penggajian
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_quality_control_process" name="has_quality_control_process">
                                <label class="form-check-label" for="has_quality_control_process">
                                    Memiliki proses kontrol kualitas
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_employee_handbook_or_sop" name="has_employee_handbook_or_sop">
                                <label class="form-check-label" for="has_employee_handbook_or_sop">
                                    Memiliki buku pegangan karyawan atau SOP
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="has_formal_onboarding" name="has_formal_onboarding">
                                <label class="form-check-label" for="has_formal_onboarding">
                                    Memiliki proses onboarding formal
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Business Goals -->
                <div class="form-section">
                    <div class="form-section-header">
                        <i class="fas fa-bullseye"></i> Tujuan Bisnis
                    </div>
                    <div class="form-section-body">
                        <div class="mb-4">
                            <label for="business_goals" class="form-label">Apa tujuan bisnis Anda untuk 1 tahun ke depan?</label>
                            <textarea class="form-control" id="business_goals" name="business_goals" rows="4" required></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="interested_in_mentoring" name="interested_in_mentoring">
                                <label class="form-check-label" for="interested_in_mentoring">
                                    Tertarik dengan program mentoring
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <div id="recaptcha-container"></div>
                    <button type="submit" class="submit-btn" id="submitBtn">Kirim Assessment</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://www.google.com/recaptcha/enterprise.js?render={{ recaptcha_site_key }}"></script>
<script>
    // Add smooth animations
    document.addEventListener('DOMContentLoaded', function() {
        const sections = document.querySelectorAll('.form-section');
        
        // Add staggered fade-in effect
        sections.forEach((section, index) => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
            
            setTimeout(() => {
                section.style.opacity = '1';
                section.style.transform = 'translateY(0)';
            }, 100 * index);
        });

        // Handle form submission
        const form = document.getElementById('assessmentForm');
        const submitBtn = document.getElementById('submitBtn');

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Mengirim...';

            grecaptcha.enterprise.ready(async () => {
                try {
                    const token = await grecaptcha.enterprise.execute('{{ recaptcha_site_key }}', {action: 'submit'});
                    
                    // Add token to form data
                    const formData = new FormData(form);
                    formData.append('recaptcha-token', token);

                    // Submit the form
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-CSRFToken': '{{ csrf_token }}'
                        }
                    });

                    if (response.redirected) {
                        window.location.href = response.url;
                    } else {
                        const data = await response.json();
                        if (data.error) {
                            alert(data.error);
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = 'Kirim Assessment';
                        }
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'Kirim Assessment';
                }
            });
        });
    });
</script>
{% endblock %} 